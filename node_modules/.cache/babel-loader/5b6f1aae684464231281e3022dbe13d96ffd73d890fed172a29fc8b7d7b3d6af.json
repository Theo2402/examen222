{"ast":null,"code":"import React,{useRef}from'react';import QRCode from'qrcode.react';import'../css/AdminUsersPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UsersPage=_ref=>{let{users,purchases,setShowConfirmDialog,confirmDeleteUser,expandedUsers,toggleUserDetails,searchTerm,setSearchTerm}=_ref;const cardRefs=useRef({});const handleToggleUserDetails=uuid=>{toggleUserDetails(uuid);const cardElement=cardRefs.current[uuid];if(cardElement){const rect=cardElement.getBoundingClientRect();const viewportHeight=window.innerHeight;if(rect.bottom>viewportHeight){cardElement.scrollIntoView({behavior:'smooth',block:'end'});}}};// Filtrer les username 'admin'\nconst filteredUsers=users.filter(user=>user.username.toLowerCase()!=='admin'&&(user.name.toLowerCase().includes(searchTerm.toLowerCase())||user.uuid.toLowerCase().includes(searchTerm.toLowerCase())||user.email.toLowerCase().includes(searchTerm.toLowerCase())));return/*#__PURE__*/_jsx(\"div\",{className:\"admin-card-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"admin-card-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"admin-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Liste des utilisateurs et des achats\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-card-content visible\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"admin-user-search\",placeholder:\"Search users or uuid...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)}),filteredUsers.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No users found.\"}):filteredUsers.map(user=>/*#__PURE__*/_jsxs(\"div\",{ref:el=>cardRefs.current[user.uuid]=el,className:\"admin-user-item user-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-user-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:user.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"user-email\",children:[\"email: \",user.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"uuid: \",user.uuid]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();confirmDeleteUser(user);},children:\"Delete\"})]}),expandedUsers[user.uuid]&&/*#__PURE__*/_jsxs(\"div\",{className:\"admin-user-details\",children:[/*#__PURE__*/_jsx(\"hr\",{}),purchases.filter(purchase=>purchase.user.username===user.username).length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Pas d'achat effectu\\xE9\"}):purchases.filter(purchase=>purchase.user.username===user.username).map(purchase=>/*#__PURE__*/_jsx(\"div\",{className:\"admin-purchase-item\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"admin-purchase-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"purchase-info\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"purchase-detail\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Offer:\"}),\" \",purchase.offer.title]}),/*#__PURE__*/_jsxs(\"p\",{className:\"purchase-detail\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Purchase Date:\"}),\" \",new Date(purchase.purchase_date).toLocaleString()]}),/*#__PURE__*/_jsxs(\"p\",{className:\"purchase-detail\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Safe Key:\"}),\" \",purchase.safe_key]}),/*#__PURE__*/_jsxs(\"p\",{className:\"purchase-detail\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Combined Key:\"}),\" \",purchase.combined_key]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"qr-code-wrapper\",children:/*#__PURE__*/_jsx(QRCode,{className:\"purchase-qr\",value:purchase.combined_key,size:128})})]})},purchase.id))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"achats-header\",onClick:()=>handleToggleUserDetails(user.uuid),children:[/*#__PURE__*/_jsx(\"span\",{children:\"Achats\"}),/*#__PURE__*/_jsx(\"span\",{className:\"arrow\",children:expandedUsers[user.uuid]?'▲':'▼'})]})]},user.uuid))]})]})})});};export default UsersPage;","map":{"version":3,"names":["React","useRef","QRCode","jsx","_jsx","jsxs","_jsxs","UsersPage","_ref","users","purchases","setShowConfirmDialog","confirmDeleteUser","expandedUsers","toggleUserDetails","searchTerm","setSearchTerm","cardRefs","handleToggleUserDetails","uuid","cardElement","current","rect","getBoundingClientRect","viewportHeight","window","innerHeight","bottom","scrollIntoView","behavior","block","filteredUsers","filter","user","username","toLowerCase","name","includes","email","className","children","type","placeholder","value","onChange","e","target","length","map","ref","el","onClick","stopPropagation","purchase","offer","title","Date","purchase_date","toLocaleString","safe_key","combined_key","size","id"],"sources":["/Users/theodiloreto/Desktop/examen 5 3/jo/src/components/AdminUsersPage.js"],"sourcesContent":["import React, { useRef } from 'react';\nimport QRCode from 'qrcode.react';\nimport '../css/AdminUsersPage.css';\n\nconst UsersPage = ({ users, purchases, setShowConfirmDialog, confirmDeleteUser, expandedUsers, toggleUserDetails, searchTerm, setSearchTerm }) => {\n  const cardRefs = useRef({});\n\n  const handleToggleUserDetails = (uuid) => {\n    toggleUserDetails(uuid);\n    const cardElement = cardRefs.current[uuid];\n    if (cardElement) {\n      const rect = cardElement.getBoundingClientRect();\n      const viewportHeight = window.innerHeight;\n      if (rect.bottom > viewportHeight) {\n        cardElement.scrollIntoView({ behavior: 'smooth', block: 'end' });\n      }\n    }\n  };\n\n  // Filtrer les username 'admin'\n  const filteredUsers = users.filter(user =>\n    user.username.toLowerCase() !== 'admin' && (\n      user.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      user.uuid.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      user.email.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n  );\n\n  return (\n    <div className=\"admin-card-container\">\n      <div className=\"admin-card-wrapper\">\n        <div className=\"admin-card\">\n          <h2>Liste des utilisateurs et des achats</h2>\n          <div className=\"admin-card-content visible\">\n            <input\n              type=\"text\"\n              className=\"admin-user-search\"\n              placeholder=\"Search users or uuid...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            {filteredUsers.length === 0 ? (\n              <p>No users found.</p>\n            ) : (\n              filteredUsers.map(user => (\n                <div key={user.uuid} ref={el => cardRefs.current[user.uuid] = el} className=\"admin-user-item user-card\">\n                  <div className=\"admin-user-header\">\n                    <div className=\"user-info\">\n                      <h4>{user.name}</h4>\n                      <p className=\"user-email\">email: {user.email}</p>\n                      <p>uuid: {user.uuid}</p>\n                    </div>\n                    <button onClick={(e) => { e.stopPropagation(); confirmDeleteUser(user); }}>Delete</button>\n                  </div>\n                  {expandedUsers[user.uuid] && (\n                    <div className=\"admin-user-details\">\n                      <hr />\n                      {purchases.filter(purchase => purchase.user.username === user.username).length === 0 ? (\n                        <p>Pas d'achat effectué</p>\n                      ) : (\n                        purchases\n                          .filter(purchase => purchase.user.username === user.username)\n                          .map(purchase => (\n                            <div key={purchase.id} className=\"admin-purchase-item\">\n                              <div className=\"admin-purchase-details\">\n                                <div className=\"purchase-info\">\n                                  <p className=\"purchase-detail\"><strong>Offer:</strong> {purchase.offer.title}</p>\n                                  <p className=\"purchase-detail\"><strong>Purchase Date:</strong> {new Date(purchase.purchase_date).toLocaleString()}</p>\n                                  <p className=\"purchase-detail\"><strong>Safe Key:</strong> {purchase.safe_key}</p>\n                                  <p className=\"purchase-detail\"><strong>Combined Key:</strong> {purchase.combined_key}</p>\n                                </div>\n                                <div className=\"qr-code-wrapper\">\n                                  <QRCode className=\"purchase-qr\" value={purchase.combined_key} size={128} />\n                                </div>\n                              </div>\n                            </div>\n                          ))\n                      )}\n                    </div>\n                  )}\n                  <div className=\"achats-header\" onClick={() => handleToggleUserDetails(user.uuid)}>\n                    <span>Achats</span>\n                    <span className=\"arrow\">{expandedUsers[user.uuid] ? '▲' : '▼'}</span>\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UsersPage;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}